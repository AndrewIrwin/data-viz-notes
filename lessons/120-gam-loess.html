<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.538">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Data Visualization notes - 17&nbsp; GAM and LOESS smoothing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lessons/124-collaboration.html" rel="next">
<link href="../lessons/119-linear-models.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lessons/120-gam-loess.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">GAM and LOESS smoothing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data Visualization notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/101-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Invitation to Data Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/102-intro-to-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Computer tools</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/103-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Setting up your computer</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/104-look-at-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Look at data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/105-first-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Making your first plot</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/106-version-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">What is version control software?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/302-staying-organized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Staying organized</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/107-grammar-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grammar of Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/108-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Using the grammar of graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/110-summarizing-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Summarizing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/115-facets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Facetted graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/111-reading-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Reading data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/112-reshaping-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reshaping data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/113-data-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Format tables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/114-asking-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Getting help and asking questions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/118-working-with-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/119-linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/120-gam-loess.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">GAM and LOESS smoothing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/124-collaboration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Collaborating with GitHub</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/301-data-sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Finding and accessing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/911-ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Accessibility, Bias, and Ethics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/133-reproducible-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Reproducible reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/121-PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Principal component analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/122-mds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Multidimensional scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/123-kmean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">K-means clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/125-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Making slides for presentations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/127-test-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Checking your work</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/155-dynamics-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Dynamic graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/140-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Making maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/141-mapping-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Mapping II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/142-mapping-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Alternatives to maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/130-bonus-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Working with text, factors, dates and times</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/201-colour.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Using colour well</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/133-themes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Themes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/130-graphics-output.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Graphics formatting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/134-reconstruction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Reconstructing a visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/499-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Review</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/901-TMI-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">More details about R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/999-metadata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#generalized-additive-models" id="toc-generalized-additive-models" class="nav-link active" data-scroll-target="#generalized-additive-models"><span class="header-section-number">17.1</span> Generalized Additive Models</a></li>
  <li><a href="#locally-estimated-scatterplot-smoothing-loess" id="toc-locally-estimated-scatterplot-smoothing-loess" class="nav-link" data-scroll-target="#locally-estimated-scatterplot-smoothing-loess"><span class="header-section-number">17.2</span> Locally Estimated Scatterplot Smoothing (LOESS)</a></li>
  <li><a href="#packages-used" id="toc-packages-used" class="nav-link" data-scroll-target="#packages-used"><span class="header-section-number">17.3</span> Packages used</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">17.4</span> Further reading</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="smoothing" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">GAM and LOESS smoothing</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this lesson I will show you how to create GAM and LOESS models and perform some basic tasks to interact with the R model objects that the functions create. In keeping with the goals of the course, we will primarily focus on using the models for visualization and not attempt a detailed statistical analysis of when and why you might use a particular model for inference. This means we will restrict our attention to some basic uses of these models using one predictor (x) and one response (y) variable.</p>
<section id="generalized-additive-models" class="level2" data-number="17.1"><h2 data-number="17.1" class="anchored" data-anchor-id="generalized-additive-models">
<span class="header-section-number">17.1</span> Generalized Additive Models</h2>
<p>Generalized additive models are a kind of linear regression, but instead of finding coefficients of predictor variables (e.g., intercepts, slopes), the model finds a “smooth” response function for each predictor. Typically this means that a piecewise cubic function (spline) is used to approximate the relationship between two variables. We can compute predicted values, confindence and prediction intervals, and show the smooth response function that arose from the model. We don’t provide a simple list of coefficients like we did with linear regression, because the spline curve is defined by many numbers which are not usually informative on their own.</p>
<p>Generalized additive models are most commonly used when there is no theoretical motivation for a functional relationship between the variables being studied. We’ll look at the Mauna Loa atmospheric CO2 concentration. These data increase year over year and have well-established interannual oscillations, but there is no clear function for either of these patterns.</p>
<p>We will start by using the last decade of data from Lesson 1.</p>
<div class="cell">

</div>
<p>Here is a plot of atmospheric CO2 concentration over time.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_theme</span> <span class="op">=</span> <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">co2</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">decimal_date</span>, <span class="va">co2_avg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">my_theme</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year (decimal)"</span>, y <span class="op">=</span> <span class="st">"Atmospheric CO2 (ppm)"</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The next plot shows each observation, minus the annual mean, as a function of the time of year but not the actual year. Each year’s observations are overlapped.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">co2</span> <span class="op">|&gt;</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">year_fraction</span>, <span class="va">co2_anomaly</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">my_theme</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year fraction (decimal)"</span>, y <span class="op">=</span> <span class="st">"Atmospheric CO2 anomaly (ppm)"</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here are GAM fits to both of these pairs of data using the <code>gam</code> function from the <code>mgcv</code> package. There is a <code>plot</code> function in the <code>mgcv</code> package, but I’m using a ggplot function called <code>draw</code> in the <code>gratia</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">co2_anomaly</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">year_fraction</span>, bs<span class="op">=</span><span class="st">"cs"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span></span>
<span><span class="fu">draw</span><span class="op">(</span><span class="va">g1</span>, residuals<span class="op">=</span><span class="cn">TRUE</span>, rug<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">co2_avg</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">decimal_date</span>, bs<span class="op">=</span><span class="st">"cs"</span><span class="op">)</span>,  data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span></span>
<span><span class="fu">draw</span><span class="op">(</span><span class="va">g2</span>, residuals<span class="op">=</span><span class="cn">TRUE</span>, rug<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Depending on your goal, you may find that the second plot is too smooth – the interannual oscillations are smoothed out completely. We can increase the number of “knots” (by setting <code>k=25</code>) in the spline to capture the oscillation, but this is not the way the smoothing is normally used:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">co2_avg</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">decimal_date</span>, bs<span class="op">=</span><span class="st">"cs"</span>, k <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,  data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span></span>
<span><span class="fu">draw</span><span class="op">(</span><span class="va">g3</span>, residuals<span class="op">=</span><span class="cn">TRUE</span>, rug<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is a <code>summary</code> function for GAM fits and the <code>broom</code> functions <code>glance</code> and <code>tidy</code> give access to these data, but the interpretation of this output is beyond the scope of the course:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
co2_anomaly ~ s(year_fraction, bs = "cs")

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 3.364e-15  2.673e-02       0        1

Approximate significance of smooth terms:
                   edf Ref.df     F p-value    
s(year_fraction) 8.296      9 530.7  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.976   Deviance explained = 97.8%
GCV = 0.092244  Scale est. = 0.085038  n = 119</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glance</span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logLik</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">deviance</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df.residual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">9.296072</td>
<td style="text-align: right;">-17.3669</td>
<td style="text-align: right;">55.32595</td>
<td style="text-align: right;">83.94001</td>
<td style="text-align: right;">9.328994</td>
<td style="text-align: right;">109.7039</td>
<td style="text-align: right;">119</td>
</tr></tbody>
</table>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidy</span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ref.df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: right;">8.296072</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">530.7013</td>
<td style="text-align: right;">0</td>
</tr></tbody>
</table>
</div>
</div>
<p>It is often useful to compute residuals and extract predicted values.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">co2</span> <span class="op">|&gt;</span> <span class="fu">add_residuals</span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">add_fitted</span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">scroll_box</span><span class="op">(</span>height <span class="op">=</span> <span class="st">"200px"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">year</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">month</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">decimal_date</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">co2_avg</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">year_fraction</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">co2_anomaly</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">.residual</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2011.042</td>
<td style="text-align: right;">391.33</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.3216667</td>
<td style="text-align: right;">0.4287396</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2011.125</td>
<td style="text-align: right;">391.86</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.2083333</td>
<td style="text-align: right;">0.3028578</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2011.208</td>
<td style="text-align: right;">392.60</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.9483333</td>
<td style="text-align: right;">0.1440604</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2011.292</td>
<td style="text-align: right;">393.25</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">1.5983333</td>
<td style="text-align: right;">-0.6010968</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2011.375</td>
<td style="text-align: right;">394.19</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.5383333</td>
<td style="text-align: right;">-0.5071870</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2011.458</td>
<td style="text-align: right;">393.74</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.0883333</td>
<td style="text-align: right;">-0.1757651</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2011.542</td>
<td style="text-align: right;">392.51</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.8583333</td>
<td style="text-align: right;">0.3875911</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2011.625</td>
<td style="text-align: right;">390.13</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5216667</td>
<td style="text-align: right;">0.0541267</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2011.708</td>
<td style="text-align: right;">389.08</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.5716667</td>
<td style="text-align: right;">0.3920488</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2011.792</td>
<td style="text-align: right;">388.99</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.6616667</td>
<td style="text-align: right;">0.0151298</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2011.875</td>
<td style="text-align: right;">390.28</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.3716667</td>
<td style="text-align: right;">-0.2731017</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2011.958</td>
<td style="text-align: right;">391.86</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.2083333</td>
<td style="text-align: right;">-0.2091522</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2012.042</td>
<td style="text-align: right;">393.12</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.7350000</td>
<td style="text-align: right;">0.0154062</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2012.125</td>
<td style="text-align: right;">393.86</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.0050000</td>
<td style="text-align: right;">0.0995244</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2012.208</td>
<td style="text-align: right;">394.40</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.5450000</td>
<td style="text-align: right;">-0.2592729</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2012.292</td>
<td style="text-align: right;">396.18</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.3250000</td>
<td style="text-align: right;">0.1255698</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2012.375</td>
<td style="text-align: right;">396.74</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.8850000</td>
<td style="text-align: right;">-0.1605204</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2012.458</td>
<td style="text-align: right;">395.71</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">1.8550000</td>
<td style="text-align: right;">-0.4090984</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2012.542</td>
<td style="text-align: right;">394.36</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.5050000</td>
<td style="text-align: right;">0.0342578</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2012.625</td>
<td style="text-align: right;">392.39</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.4650000</td>
<td style="text-align: right;">0.1107934</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2012.708</td>
<td style="text-align: right;">391.13</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.7250000</td>
<td style="text-align: right;">0.2387155</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2012.792</td>
<td style="text-align: right;">391.05</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.8050000</td>
<td style="text-align: right;">-0.1282035</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2012.875</td>
<td style="text-align: right;">392.98</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-0.8750000</td>
<td style="text-align: right;">0.2235650</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2012.958</td>
<td style="text-align: right;">394.34</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4850000</td>
<td style="text-align: right;">0.0675145</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2013.042</td>
<td style="text-align: right;">395.55</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.9700000</td>
<td style="text-align: right;">-0.2195938</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2013.125</td>
<td style="text-align: right;">396.80</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.2800000</td>
<td style="text-align: right;">0.3745244</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2013.208</td>
<td style="text-align: right;">397.43</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.9100000</td>
<td style="text-align: right;">0.1057271</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2013.292</td>
<td style="text-align: right;">398.41</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">1.8900000</td>
<td style="text-align: right;">-0.3094302</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2013.375</td>
<td style="text-align: right;">399.78</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.2600000</td>
<td style="text-align: right;">0.2144796</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2013.458</td>
<td style="text-align: right;">398.60</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.0800000</td>
<td style="text-align: right;">-0.1840984</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2013.542</td>
<td style="text-align: right;">397.32</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.8000000</td>
<td style="text-align: right;">0.3292578</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2013.625</td>
<td style="text-align: right;">395.20</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.3200000</td>
<td style="text-align: right;">0.2557934</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2013.708</td>
<td style="text-align: right;">393.45</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-3.0700000</td>
<td style="text-align: right;">-0.1062845</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2013.792</td>
<td style="text-align: right;">393.70</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.8200000</td>
<td style="text-align: right;">-0.1432035</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2013.875</td>
<td style="text-align: right;">395.16</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.3600000</td>
<td style="text-align: right;">-0.2614350</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2013.958</td>
<td style="text-align: right;">396.84</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.3200000</td>
<td style="text-align: right;">-0.0974855</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2014.042</td>
<td style="text-align: right;">397.85</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.7925000</td>
<td style="text-align: right;">-0.0420938</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2014.125</td>
<td style="text-align: right;">398.01</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">-0.6325000</td>
<td style="text-align: right;">-0.5379756</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2014.208</td>
<td style="text-align: right;">399.71</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.0675000</td>
<td style="text-align: right;">0.2632271</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2014.292</td>
<td style="text-align: right;">401.33</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.6875000</td>
<td style="text-align: right;">0.4880698</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2014.375</td>
<td style="text-align: right;">401.78</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.1375000</td>
<td style="text-align: right;">0.0919796</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2014.458</td>
<td style="text-align: right;">401.25</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.6075000</td>
<td style="text-align: right;">0.3434016</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2014.542</td>
<td style="text-align: right;">399.11</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4675000</td>
<td style="text-align: right;">-0.0032422</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2014.625</td>
<td style="text-align: right;">397.03</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.6125000</td>
<td style="text-align: right;">-0.0367066</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2014.708</td>
<td style="text-align: right;">395.38</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-3.2625000</td>
<td style="text-align: right;">-0.2987845</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2014.792</td>
<td style="text-align: right;">396.07</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.5725000</td>
<td style="text-align: right;">0.1042965</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2014.875</td>
<td style="text-align: right;">397.28</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.3625000</td>
<td style="text-align: right;">-0.2639350</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2014.958</td>
<td style="text-align: right;">398.91</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.2675000</td>
<td style="text-align: right;">-0.1499855</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2015.042</td>
<td style="text-align: right;">399.98</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.8458333</td>
<td style="text-align: right;">-0.0954271</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2015.125</td>
<td style="text-align: right;">400.35</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">-0.4758333</td>
<td style="text-align: right;">-0.3813089</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2015.208</td>
<td style="text-align: right;">401.52</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.6941667</td>
<td style="text-align: right;">-0.1101062</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2015.292</td>
<td style="text-align: right;">403.15</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.3241667</td>
<td style="text-align: right;">0.1247365</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2015.375</td>
<td style="text-align: right;">403.96</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.1341667</td>
<td style="text-align: right;">0.0886463</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2015.458</td>
<td style="text-align: right;">402.80</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">1.9741667</td>
<td style="text-align: right;">-0.2899317</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2015.542</td>
<td style="text-align: right;">401.29</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4641667</td>
<td style="text-align: right;">-0.0065755</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2015.625</td>
<td style="text-align: right;">398.93</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.8958333</td>
<td style="text-align: right;">-0.3200400</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2015.708</td>
<td style="text-align: right;">397.63</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-3.1958333</td>
<td style="text-align: right;">-0.2321178</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2015.792</td>
<td style="text-align: right;">398.29</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.5358333</td>
<td style="text-align: right;">0.1409631</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2015.875</td>
<td style="text-align: right;">400.16</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-0.6658333</td>
<td style="text-align: right;">0.4327317</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2015.958</td>
<td style="text-align: right;">401.85</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">1.0241667</td>
<td style="text-align: right;">0.6066812</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2016.042</td>
<td style="text-align: right;">402.50</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.7225000</td>
<td style="text-align: right;">-0.9720938</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2016.125</td>
<td style="text-align: right;">404.07</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">-0.1525000</td>
<td style="text-align: right;">-0.0579756</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2016.208</td>
<td style="text-align: right;">404.87</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.6475000</td>
<td style="text-align: right;">-0.1567729</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2016.292</td>
<td style="text-align: right;">407.42</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">3.1975000</td>
<td style="text-align: right;">0.9980698</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2016.375</td>
<td style="text-align: right;">407.72</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.4975000</td>
<td style="text-align: right;">0.4519796</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2016.458</td>
<td style="text-align: right;">406.81</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.5875000</td>
<td style="text-align: right;">0.3234016</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2016.542</td>
<td style="text-align: right;">404.40</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.1775000</td>
<td style="text-align: right;">-0.2932422</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2016.625</td>
<td style="text-align: right;">402.26</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.9625000</td>
<td style="text-align: right;">-0.3867066</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2016.708</td>
<td style="text-align: right;">401.05</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-3.1725000</td>
<td style="text-align: right;">-0.2087845</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2016.792</td>
<td style="text-align: right;">401.60</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.6225000</td>
<td style="text-align: right;">0.0542965</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2016.875</td>
<td style="text-align: right;">403.53</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-0.6925000</td>
<td style="text-align: right;">0.4060650</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2016.958</td>
<td style="text-align: right;">404.44</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.2175000</td>
<td style="text-align: right;">-0.1999855</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017.042</td>
<td style="text-align: right;">406.17</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.3850000</td>
<td style="text-align: right;">0.3654062</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2017.125</td>
<td style="text-align: right;">406.47</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">-0.0850000</td>
<td style="text-align: right;">0.0095244</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2017.208</td>
<td style="text-align: right;">407.23</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.6750000</td>
<td style="text-align: right;">-0.1292729</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2017.292</td>
<td style="text-align: right;">409.03</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.4750000</td>
<td style="text-align: right;">0.2755698</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2017.375</td>
<td style="text-align: right;">409.69</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.1350000</td>
<td style="text-align: right;">0.0894796</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2017.458</td>
<td style="text-align: right;">408.89</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.3350000</td>
<td style="text-align: right;">0.0709016</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2017.542</td>
<td style="text-align: right;">407.13</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.5750000</td>
<td style="text-align: right;">0.1042578</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2017.625</td>
<td style="text-align: right;">405.12</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.4350000</td>
<td style="text-align: right;">0.1407934</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2017.708</td>
<td style="text-align: right;">403.37</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-3.1850000</td>
<td style="text-align: right;">-0.2212845</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2017.792</td>
<td style="text-align: right;">403.63</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.9250000</td>
<td style="text-align: right;">-0.2482035</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2017.875</td>
<td style="text-align: right;">405.12</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4350000</td>
<td style="text-align: right;">-0.3364350</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2017.958</td>
<td style="text-align: right;">406.81</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.2550000</td>
<td style="text-align: right;">-0.1624855</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2018.042</td>
<td style="text-align: right;">407.96</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.5600000</td>
<td style="text-align: right;">0.1904062</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2018.125</td>
<td style="text-align: right;">408.32</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">-0.2000000</td>
<td style="text-align: right;">-0.1054756</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2018.208</td>
<td style="text-align: right;">409.39</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.8700000</td>
<td style="text-align: right;">0.0657271</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2018.292</td>
<td style="text-align: right;">410.25</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">1.7300000</td>
<td style="text-align: right;">-0.4694302</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2018.375</td>
<td style="text-align: right;">411.24</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7200000</td>
<td style="text-align: right;">-0.3255204</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2018.458</td>
<td style="text-align: right;">410.79</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.2700000</td>
<td style="text-align: right;">0.0059016</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2018.542</td>
<td style="text-align: right;">408.70</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.1800000</td>
<td style="text-align: right;">-0.2907422</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2018.625</td>
<td style="text-align: right;">406.97</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5500000</td>
<td style="text-align: right;">0.0257934</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2018.708</td>
<td style="text-align: right;">405.52</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-3.0000000</td>
<td style="text-align: right;">-0.0362845</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2018.792</td>
<td style="text-align: right;">406.00</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.5200000</td>
<td style="text-align: right;">0.1567965</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2018.875</td>
<td style="text-align: right;">408.02</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-0.5000000</td>
<td style="text-align: right;">0.5985650</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2018.958</td>
<td style="text-align: right;">409.08</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.5600000</td>
<td style="text-align: right;">0.1425145</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2019.042</td>
<td style="text-align: right;">410.83</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.6041667</td>
<td style="text-align: right;">0.1462396</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2019.125</td>
<td style="text-align: right;">411.75</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3158333</td>
<td style="text-align: right;">0.4103578</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2019.208</td>
<td style="text-align: right;">411.97</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.5358333</td>
<td style="text-align: right;">-0.2684396</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2019.292</td>
<td style="text-align: right;">413.33</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">1.8958333</td>
<td style="text-align: right;">-0.3035968</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2019.375</td>
<td style="text-align: right;">414.64</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.2058333</td>
<td style="text-align: right;">0.1603130</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2019.458</td>
<td style="text-align: right;">413.93</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.4958333</td>
<td style="text-align: right;">0.2317349</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2019.542</td>
<td style="text-align: right;">411.74</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.3058333</td>
<td style="text-align: right;">-0.1649089</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2019.625</td>
<td style="text-align: right;">409.95</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.4841667</td>
<td style="text-align: right;">0.0916267</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2019.708</td>
<td style="text-align: right;">408.54</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.8941667</td>
<td style="text-align: right;">0.0695488</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2019.792</td>
<td style="text-align: right;">408.52</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.9141667</td>
<td style="text-align: right;">-0.2373702</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2019.875</td>
<td style="text-align: right;">410.25</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.1841667</td>
<td style="text-align: right;">-0.0856017</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2019.958</td>
<td style="text-align: right;">411.76</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.3258333</td>
<td style="text-align: right;">-0.0916522</td>
<td style="text-align: right;">0.4174855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2020.042</td>
<td style="text-align: right;">413.39</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-0.6154545</td>
<td style="text-align: right;">0.1349517</td>
<td style="text-align: right;">-0.7504062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2020.125</td>
<td style="text-align: right;">414.11</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.1045455</td>
<td style="text-align: right;">0.1990699</td>
<td style="text-align: right;">-0.0945244</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2020.208</td>
<td style="text-align: right;">414.51</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">0.5045455</td>
<td style="text-align: right;">-0.2997274</td>
<td style="text-align: right;">0.8042729</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2020.292</td>
<td style="text-align: right;">416.21</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2045455</td>
<td style="text-align: right;">0.0051153</td>
<td style="text-align: right;">2.1994302</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2020.375</td>
<td style="text-align: right;">417.07</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">3.0645455</td>
<td style="text-align: right;">0.0190251</td>
<td style="text-align: right;">3.0455204</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2020.458</td>
<td style="text-align: right;">416.38</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.3745455</td>
<td style="text-align: right;">0.1104471</td>
<td style="text-align: right;">2.2640984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2020.542</td>
<td style="text-align: right;">414.38</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.3745455</td>
<td style="text-align: right;">-0.0961967</td>
<td style="text-align: right;">0.4707422</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2020.625</td>
<td style="text-align: right;">412.55</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.4554545</td>
<td style="text-align: right;">0.1203388</td>
<td style="text-align: right;">-1.5757934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2020.708</td>
<td style="text-align: right;">411.29</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.7154545</td>
<td style="text-align: right;">0.2482610</td>
<td style="text-align: right;">-2.9637155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2020.792</td>
<td style="text-align: right;">411.28</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.7254545</td>
<td style="text-align: right;">-0.0486581</td>
<td style="text-align: right;">-2.6767965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2020.875</td>
<td style="text-align: right;">412.89</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.1154545</td>
<td style="text-align: right;">-0.0168896</td>
<td style="text-align: right;">-1.0985650</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>If we generate new data (dates), we can plot predictions too. Since the model is a piecewise cubic function, extrapolations are often dramatically unreliable. The downward facing cubic in the last “bump” is simply continued, with comically bad results. Extrapolation of models, and especially smooths, is somewhere between risky and foolish!</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>decimal_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2022</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_data</span> <span class="op">|&gt;</span> <span class="fu">add_fitted</span><span class="op">(</span><span class="va">g3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">decimal_date</span>, <span class="va">.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span> <span class="va">co2_avg</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span> <span class="op">+</span> <span class="va">my_theme</span> <span class="op">+</span> <span class="fu">xlim</span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2022</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If you want confidence intervals on the fitted values, use the <code>confint</code> function together with the name of the smooth you are extracting. Be aware that this function does not include the intercept (or grand mean) from the model, so the values are all centred on zero.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">g1</span>, <span class="st">"s(year_fraction)"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">scroll_box</span><span class="op">(</span>height <span class="op">=</span> <span class="st">"200px"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">smooth</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">type</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">by</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">year_fraction</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">est</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">se</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">crit</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">lower</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0417000</td>
<td style="text-align: right;">-0.7504062</td>
<td style="text-align: right;">0.0911643</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.9290849</td>
<td style="text-align: right;">-0.5717275</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0509586</td>
<td style="text-align: right;">-0.6817578</td>
<td style="text-align: right;">0.0809578</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.8404323</td>
<td style="text-align: right;">-0.5230834</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0602172</td>
<td style="text-align: right;">-0.6127904</td>
<td style="text-align: right;">0.0733927</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.7566374</td>
<td style="text-align: right;">-0.4689434</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0694758</td>
<td style="text-align: right;">-0.5431848</td>
<td style="text-align: right;">0.0690820</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.6785830</td>
<td style="text-align: right;">-0.4077867</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0787343</td>
<td style="text-align: right;">-0.4726221</td>
<td style="text-align: right;">0.0681206</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.6061360</td>
<td style="text-align: right;">-0.3391083</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0879929</td>
<td style="text-align: right;">-0.4007832</td>
<td style="text-align: right;">0.0699213</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.5378264</td>
<td style="text-align: right;">-0.2637400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.0972515</td>
<td style="text-align: right;">-0.3273490</td>
<td style="text-align: right;">0.0734372</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.4712834</td>
<td style="text-align: right;">-0.1834146</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1065101</td>
<td style="text-align: right;">-0.2520005</td>
<td style="text-align: right;">0.0775479</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.4039916</td>
<td style="text-align: right;">-0.1000094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1157687</td>
<td style="text-align: right;">-0.1744186</td>
<td style="text-align: right;">0.0812998</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.3337632</td>
<td style="text-align: right;">-0.0150740</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1250273</td>
<td style="text-align: right;">-0.0942843</td>
<td style="text-align: right;">0.0839689</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.2588604</td>
<td style="text-align: right;">0.0702918</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1342859</td>
<td style="text-align: right;">-0.0112785</td>
<td style="text-align: right;">0.0850509</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.1779752</td>
<td style="text-align: right;">0.1554181</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1435444</td>
<td style="text-align: right;">0.0749178</td>
<td style="text-align: right;">0.0842571</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.0902230</td>
<td style="text-align: right;">0.2400586</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1528030</td>
<td style="text-align: right;">0.1646548</td>
<td style="text-align: right;">0.0816675</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.0045895</td>
<td style="text-align: right;">0.3247201</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1620616</td>
<td style="text-align: right;">0.2584060</td>
<td style="text-align: right;">0.0780515</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.1054279</td>
<td style="text-align: right;">0.4113841</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1713202</td>
<td style="text-align: right;">0.3566751</td>
<td style="text-align: right;">0.0744217</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.2108112</td>
<td style="text-align: right;">0.5025390</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1805788</td>
<td style="text-align: right;">0.4599660</td>
<td style="text-align: right;">0.0717896</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.3192609</td>
<td style="text-align: right;">0.6006710</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1898374</td>
<td style="text-align: right;">0.5687826</td>
<td style="text-align: right;">0.0709348</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.4297529</td>
<td style="text-align: right;">0.7078123</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.1990960</td>
<td style="text-align: right;">0.6836286</td>
<td style="text-align: right;">0.0721338</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.5422489</td>
<td style="text-align: right;">0.8250084</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2083545</td>
<td style="text-align: right;">0.8050081</td>
<td style="text-align: right;">0.0750447</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.6579232</td>
<td style="text-align: right;">0.9520929</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2176131</td>
<td style="text-align: right;">0.9334248</td>
<td style="text-align: right;">0.0788582</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.7788655</td>
<td style="text-align: right;">1.0879841</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2268717</td>
<td style="text-align: right;">1.0693825</td>
<td style="text-align: right;">0.0825780</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.9075326</td>
<td style="text-align: right;">1.2312324</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2361303</td>
<td style="text-align: right;">1.2133852</td>
<td style="text-align: right;">0.0852431</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.0463118</td>
<td style="text-align: right;">1.3804586</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2453889</td>
<td style="text-align: right;">1.3659367</td>
<td style="text-align: right;">0.0860568</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.1972685</td>
<td style="text-align: right;">1.5346049</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2546475</td>
<td style="text-align: right;">1.5269337</td>
<td style="text-align: right;">0.0846483</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.3610260</td>
<td style="text-align: right;">1.6928413</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2639061</td>
<td style="text-align: right;">1.6938620</td>
<td style="text-align: right;">0.0816108</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.5339079</td>
<td style="text-align: right;">1.8538162</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2731646</td>
<td style="text-align: right;">1.8636092</td>
<td style="text-align: right;">0.0779237</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.7108815</td>
<td style="text-align: right;">2.0163368</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2824232</td>
<td style="text-align: right;">2.0330625</td>
<td style="text-align: right;">0.0746645</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.8867229</td>
<td style="text-align: right;">2.1794022</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.2916818</td>
<td style="text-align: right;">2.1991095</td>
<td style="text-align: right;">0.0728082</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.0564080</td>
<td style="text-align: right;">2.3418110</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3009404</td>
<td style="text-align: right;">2.3586375</td>
<td style="text-align: right;">0.0729367</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.2156842</td>
<td style="text-align: right;">2.5015908</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3101990</td>
<td style="text-align: right;">2.5085339</td>
<td style="text-align: right;">0.0750030</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.3615307</td>
<td style="text-align: right;">2.6555371</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3194576</td>
<td style="text-align: right;">2.6456862</td>
<td style="text-align: right;">0.0783538</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.4921155</td>
<td style="text-align: right;">2.7992569</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3287162</td>
<td style="text-align: right;">2.7669818</td>
<td style="text-align: right;">0.0819890</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.6062862</td>
<td style="text-align: right;">2.9276773</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3379747</td>
<td style="text-align: right;">2.8693080</td>
<td style="text-align: right;">0.0848477</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.7030096</td>
<td style="text-align: right;">3.0356064</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3472333</td>
<td style="text-align: right;">2.9495523</td>
<td style="text-align: right;">0.0859988</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.7809978</td>
<td style="text-align: right;">3.1181068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3564919</td>
<td style="text-align: right;">3.0053003</td>
<td style="text-align: right;">0.0849387</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.8388235</td>
<td style="text-align: right;">3.1717772</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3657505</td>
<td style="text-align: right;">3.0369301</td>
<td style="text-align: right;">0.0821714</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.8758770</td>
<td style="text-align: right;">3.1979831</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3750091</td>
<td style="text-align: right;">3.0455178</td>
<td style="text-align: right;">0.0786209</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.8914238</td>
<td style="text-align: right;">3.1996119</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3842677</td>
<td style="text-align: right;">3.0321399</td>
<td style="text-align: right;">0.0753299</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.8844960</td>
<td style="text-align: right;">3.1797837</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.3935263</td>
<td style="text-align: right;">2.9978724</td>
<td style="text-align: right;">0.0732708</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.8542642</td>
<td style="text-align: right;">3.1414805</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4027848</td>
<td style="text-align: right;">2.9437916</td>
<td style="text-align: right;">0.0730697</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.8005775</td>
<td style="text-align: right;">3.0870057</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4120434</td>
<td style="text-align: right;">2.8709738</td>
<td style="text-align: right;">0.0747628</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.7244414</td>
<td style="text-align: right;">3.0175062</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4213020</td>
<td style="text-align: right;">2.7804953</td>
<td style="text-align: right;">0.0777795</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.6280503</td>
<td style="text-align: right;">2.9329403</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4305606</td>
<td style="text-align: right;">2.6734322</td>
<td style="text-align: right;">0.0811704</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.5143412</td>
<td style="text-align: right;">2.8325232</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4398192</td>
<td style="text-align: right;">2.5508609</td>
<td style="text-align: right;">0.0838921</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.3864353</td>
<td style="text-align: right;">2.7152864</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4490778</td>
<td style="text-align: right;">2.4138575</td>
<td style="text-align: right;">0.0850125</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.2472359</td>
<td style="text-align: right;">2.5804790</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4583364</td>
<td style="text-align: right;">2.2634829</td>
<td style="text-align: right;">0.0840212</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.0988044</td>
<td style="text-align: right;">2.4281614</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4675949</td>
<td style="text-align: right;">2.1007375</td>
<td style="text-align: right;">0.0814056</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.9411854</td>
<td style="text-align: right;">2.2602895</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4768535</td>
<td style="text-align: right;">1.9266062</td>
<td style="text-align: right;">0.0780703</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.7735911</td>
<td style="text-align: right;">2.0796212</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4861121</td>
<td style="text-align: right;">1.7420743</td>
<td style="text-align: right;">0.0750319</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.5950145</td>
<td style="text-align: right;">1.8891340</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.4953707</td>
<td style="text-align: right;">1.5481269</td>
<td style="text-align: right;">0.0732232</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.4046120</td>
<td style="text-align: right;">1.6916417</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5046293</td>
<td style="text-align: right;">1.3457491</td>
<td style="text-align: right;">0.0732233</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">1.2022340</td>
<td style="text-align: right;">1.4892643</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5138879</td>
<td style="text-align: right;">1.1359263</td>
<td style="text-align: right;">0.0750322</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.9888658</td>
<td style="text-align: right;">1.2829867</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5231465</td>
<td style="text-align: right;">0.9196434</td>
<td style="text-align: right;">0.0780708</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.7666274</td>
<td style="text-align: right;">1.0726594</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5324051</td>
<td style="text-align: right;">0.6978857</td>
<td style="text-align: right;">0.0814061</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.5383327</td>
<td style="text-align: right;">0.8574387</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5416636</td>
<td style="text-align: right;">0.4716384</td>
<td style="text-align: right;">0.0840216</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.3069591</td>
<td style="text-align: right;">0.6363176</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5509222</td>
<td style="text-align: right;">0.2418865</td>
<td style="text-align: right;">0.0850127</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.0752646</td>
<td style="text-align: right;">0.4085084</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5601808</td>
<td style="text-align: right;">0.0096704</td>
<td style="text-align: right;">0.0838921</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.1547552</td>
<td style="text-align: right;">0.1740959</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5694394</td>
<td style="text-align: right;">-0.2237469</td>
<td style="text-align: right;">0.0811703</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.3828378</td>
<td style="text-align: right;">-0.0646561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5786980</td>
<td style="text-align: right;">-0.4570459</td>
<td style="text-align: right;">0.0777795</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.6094909</td>
<td style="text-align: right;">-0.3046010</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5879566</td>
<td style="text-align: right;">-0.6889073</td>
<td style="text-align: right;">0.0747631</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.8354404</td>
<td style="text-align: right;">-0.5423742</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.5972152</td>
<td style="text-align: right;">-0.9180116</td>
<td style="text-align: right;">0.0730706</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.0612274</td>
<td style="text-align: right;">-0.7747958</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6064737</td>
<td style="text-align: right;">-1.1430394</td>
<td style="text-align: right;">0.0732723</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.2866505</td>
<td style="text-align: right;">-0.9994283</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6157323</td>
<td style="text-align: right;">-1.3626714</td>
<td style="text-align: right;">0.0753319</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.5103193</td>
<td style="text-align: right;">-1.2150235</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6249909</td>
<td style="text-align: right;">-1.5755880</td>
<td style="text-align: right;">0.0786232</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.7296867</td>
<td style="text-align: right;">-1.4214894</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6342495</td>
<td style="text-align: right;">-1.7804700</td>
<td style="text-align: right;">0.0821737</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.9415275</td>
<td style="text-align: right;">-1.6194126</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6435081</td>
<td style="text-align: right;">-1.9759979</td>
<td style="text-align: right;">0.0849405</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.1424783</td>
<td style="text-align: right;">-1.8095176</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6527667</td>
<td style="text-align: right;">-2.1608524</td>
<td style="text-align: right;">0.0859999</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.3294090</td>
<td style="text-align: right;">-1.9922957</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6620253</td>
<td style="text-align: right;">-2.3336765</td>
<td style="text-align: right;">0.0848480</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.4999756</td>
<td style="text-align: right;">-2.1673774</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6712838</td>
<td style="text-align: right;">-2.4929639</td>
<td style="text-align: right;">0.0819890</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.6536594</td>
<td style="text-align: right;">-2.3322684</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6805424</td>
<td style="text-align: right;">-2.6371709</td>
<td style="text-align: right;">0.0783543</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.7907424</td>
<td style="text-align: right;">-2.4835994</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6898010</td>
<td style="text-align: right;">-2.7647537</td>
<td style="text-align: right;">0.0750049</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.9117606</td>
<td style="text-align: right;">-2.6177467</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.6990596</td>
<td style="text-align: right;">-2.8741684</td>
<td style="text-align: right;">0.0729410</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.0171302</td>
<td style="text-align: right;">-2.7312066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7083182</td>
<td style="text-align: right;">-2.9638713</td>
<td style="text-align: right;">0.0728153</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.1065867</td>
<td style="text-align: right;">-2.8211559</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7175768</td>
<td style="text-align: right;">-3.0323187</td>
<td style="text-align: right;">0.0746737</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.1786765</td>
<td style="text-align: right;">-2.8859609</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7268354</td>
<td style="text-align: right;">-3.0779667</td>
<td style="text-align: right;">0.0779337</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.2307140</td>
<td style="text-align: right;">-2.9252194</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7360939</td>
<td style="text-align: right;">-3.0992716</td>
<td style="text-align: right;">0.0816198</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.2592435</td>
<td style="text-align: right;">-2.9392997</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7453525</td>
<td style="text-align: right;">-3.0946895</td>
<td style="text-align: right;">0.0846548</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.2606099</td>
<td style="text-align: right;">-2.9287691</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7546111</td>
<td style="text-align: right;">-3.0626767</td>
<td style="text-align: right;">0.0860599</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.2313511</td>
<td style="text-align: right;">-2.8940024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7638697</td>
<td style="text-align: right;">-3.0024381</td>
<td style="text-align: right;">0.0852435</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.1695122</td>
<td style="text-align: right;">-2.8353639</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7731283</td>
<td style="text-align: right;">-2.9161942</td>
<td style="text-align: right;">0.0825787</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-3.0780455</td>
<td style="text-align: right;">-2.7543430</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7823869</td>
<td style="text-align: right;">-2.8069254</td>
<td style="text-align: right;">0.0788645</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.9614971</td>
<td style="text-align: right;">-2.6523537</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.7916455</td>
<td style="text-align: right;">-2.6776118</td>
<td style="text-align: right;">0.0750630</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.8247325</td>
<td style="text-align: right;">-2.5304911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8009040</td>
<td style="text-align: right;">-2.5312335</td>
<td style="text-align: right;">0.0721692</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.6726826</td>
<td style="text-align: right;">-2.3897844</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8101626</td>
<td style="text-align: right;">-2.3707707</td>
<td style="text-align: right;">0.0709881</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.5099048</td>
<td style="text-align: right;">-2.2316366</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8194212</td>
<td style="text-align: right;">-2.1992036</td>
<td style="text-align: right;">0.0718551</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.3400371</td>
<td style="text-align: right;">-2.0583701</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8286798</td>
<td style="text-align: right;">-2.0195124</td>
<td style="text-align: right;">0.0744886</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-2.1655074</td>
<td style="text-align: right;">-1.8735174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8379384</td>
<td style="text-align: right;">-1.8346772</td>
<td style="text-align: right;">0.0781075</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.9877650</td>
<td style="text-align: right;">-1.6815894</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8471970</td>
<td style="text-align: right;">-1.6476782</td>
<td style="text-align: right;">0.0817031</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.8078133</td>
<td style="text-align: right;">-1.4875431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8564556</td>
<td style="text-align: right;">-1.4614956</td>
<td style="text-align: right;">0.0842698</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.6266614</td>
<td style="text-align: right;">-1.2963298</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8657141</td>
<td style="text-align: right;">-1.2785611</td>
<td style="text-align: right;">0.0850509</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.4452578</td>
<td style="text-align: right;">-1.1118643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8749727</td>
<td style="text-align: right;">-1.0990889</td>
<td style="text-align: right;">0.0839870</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.2637004</td>
<td style="text-align: right;">-0.9344774</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8842313</td>
<td style="text-align: right;">-0.9227328</td>
<td style="text-align: right;">0.0813947</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-1.0822634</td>
<td style="text-align: right;">-0.7632021</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.8934899</td>
<td style="text-align: right;">-0.7491465</td>
<td style="text-align: right;">0.0778161</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.9016632</td>
<td style="text-align: right;">-0.5966297</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9027485</td>
<td style="text-align: right;">-0.5779838</td>
<td style="text-align: right;">0.0740205</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.7230612</td>
<td style="text-align: right;">-0.4329063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9120071</td>
<td style="text-align: right;">-0.4088984</td>
<td style="text-align: right;">0.0710025</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.5480608</td>
<td style="text-align: right;">-0.2697361</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9212657</td>
<td style="text-align: right;">-0.2415443</td>
<td style="text-align: right;">0.0698894</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.3785249</td>
<td style="text-align: right;">-0.1045636</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9305242</td>
<td style="text-align: right;">-0.0755750</td>
<td style="text-align: right;">0.0716663</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.2160385</td>
<td style="text-align: right;">0.0648884</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9397828</td>
<td style="text-align: right;">0.0893555</td>
<td style="text-align: right;">0.0768071</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">-0.0611835</td>
<td style="text-align: right;">0.2398946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9490414</td>
<td style="text-align: right;">0.2535936</td>
<td style="text-align: right;">0.0851238</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.0867541</td>
<td style="text-align: right;">0.4204332</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(year_fraction)</td>
<td style="text-align: left;">CRS (shrink)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0.9583000</td>
<td style="text-align: right;">0.4174855</td>
<td style="text-align: right;">0.0959747</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">0.2293786</td>
<td style="text-align: right;">0.6055924</td>
</tr>
</tbody>
</table>
</div>

</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">g1</span>, <span class="st">"s(year_fraction)"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">year_fraction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can also use <code>lm</code> to fit splines; these are similar to GAMs but there are some important differences. The <code>mgcv</code> package has a lot of features not available with <code>lm</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">co2_avg</span> <span class="op">~</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/bs.html">bs</a></span><span class="op">(</span><span class="va">decimal_date</span>, df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">s1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">391.73</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">347.53</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">splines::bs(decimal_date, df = 5)1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">splines::bs(decimal_date, df = 5)2</td>
<td style="text-align: right;">6.87</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">4.69</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">splines::bs(decimal_date, df = 5)3</td>
<td style="text-align: right;">14.49</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">7.31</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">splines::bs(decimal_date, df = 5)4</td>
<td style="text-align: right;">21.01</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">13.01</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">splines::bs(decimal_date, df = 5)5</td>
<td style="text-align: right;">22.14</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glance</span><span class="op">(</span><span class="va">s1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">r.squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adj.r.squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sigma</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logLik</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">deviance</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df.residual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nobs</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">219.14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">-265.4</td>
<td style="text-align: right;">544.8</td>
<td style="text-align: right;">564.26</td>
<td style="text-align: right;">602.91</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">119</td>
</tr></tbody>
</table>
</div>
</div>
<p>We can use <code>augment</code> to generate data to plot and combine it with the original data.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">s1</span>, data <span class="op">=</span> <span class="va">co2</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span> </span>
<span><span class="va">a1</span> <span class="op">|&gt;</span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">decimal_date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">co2_avg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For a spline that closely traces the data, increase <code>df</code> to 26 or more. This increases the numbers of knots or separate cubics used to approximate the data.</p>
</section><section id="locally-estimated-scatterplot-smoothing-loess" class="level2" data-number="17.2"><h2 data-number="17.2" class="anchored" data-anchor-id="locally-estimated-scatterplot-smoothing-loess">
<span class="header-section-number">17.2</span> Locally Estimated Scatterplot Smoothing (LOESS)</h2>
<p>LOESS smooths are constructed by making a large number of quadratic (or possibly linear) regression lines as a window moves along the x-axis. The degree of the fits and the width of the window (and other details) can be adjusted. The predictions from these many local regressions are then computed and plotted as a “smooth” of the data. We usually just imagine the line is drawn through the data in a way that allows it to track fluctuations without specifying a model.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">co2_anomaly</span> <span class="op">~</span> <span class="va">year_fraction</span>, data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As with the GAMs, the <code>summary</code> function is not particularly easy to interpret and we will not explore the details, but you can see that this is a quadratic model with a “span” of 0.75, meaning that 75% of the data are used for each regression. (The weighting of each point in the regression varies as a function of x, resulting a continuous change in the predictions.)</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
loess(formula = co2_anomaly ~ year_fraction, data = co2)

Number of Observations: 119 
Equivalent Number of Parameters: 4.58 
Residual Standard Error: 0.4647 
Trace of smoother matrix: 5  (exact)

Control settings:
  span     :  0.75 
  degree   :  2 
  family   :  gaussian
  surface  :  interpolate     cell = 0.2
  normalize:  TRUE
 parametric:  FALSE
drop.square:  FALSE </code></pre>
</div>
</div>
<p>We can use <code>predict</code>, <code>residuals</code> and <code>augment</code> on these model objects as we did for <code>lm</code> fits in the previous lesson.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">augment</span><span class="op">(</span><span class="va">l1</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">scroll_box</span><span class="op">(</span>height <span class="op">=</span> <span class="st">"200px"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">co2_anomaly</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">year_fraction</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">.fitted</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">.se.fit</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">.resid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.3216667</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.8658149</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2083333</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.1214414</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9483333</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.5375594</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5983333</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">-0.6402698</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.5383333</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">-0.2070637</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0883333</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.0533857</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8583333</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.4280828</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.5216667</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.0067014</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.5716667</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.1155441</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.6616667</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.2743178</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.3716667</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.0456133</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2083333</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.2822341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.7350000</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.4524816</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0050000</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.3247748</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5450000</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.9408927</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.3250000</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">0.0863969</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.8850000</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.1396029</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8550000</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.2867191</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5050000</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.0747494</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.4650000</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.0633681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.7250000</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.2688774</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.8050000</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.4176512</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.8750000</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.5422800</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4850000</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.0055675</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.9700000</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.2174816</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2800000</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.0497748</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9100000</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.5758927</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8900000</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">-0.3486031</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.2600000</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.5146029</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0800000</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.0617191</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8000000</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.3697494</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.3200000</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.2083681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.0700000</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.6138774</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.8200000</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.4326512</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.3600000</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.0572800</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.3200000</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.1705675</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.7925000</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.3949816</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.6325000</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.9622748</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0675000</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.4183927</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.6875000</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">0.4488969</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.1375000</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.3921029</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.6075000</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.4657809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.4675000</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.0372494</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.6125000</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">-0.0841319</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.2625000</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.8063774</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.5725000</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.1851512</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.3625000</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.0547800</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2675000</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.2230675</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.8458333</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.3416483</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.4758333</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.8056081</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6941667</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.7917261</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.3241667</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">0.0855636</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.1341667</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.3887696</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.9741667</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.1675524</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.4641667</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.0339161</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.8958333</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">-0.3674653</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.1958333</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.7397107</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.5358333</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.1484845</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.6658333</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.7514466</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0241667</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">0.5335992</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.7225000</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">-0.5350184</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.1525000</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.4822748</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6475000</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.8383927</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.1975000</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">0.9588969</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.4975000</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.7521029</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.5875000</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.4457809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.1775000</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.2527506</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.9625000</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">-0.4341319</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.1725000</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.7163774</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.6225000</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.2351512</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.6925000</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.7247800</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2175000</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.2730675</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.3850000</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.8024816</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0850000</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.4147748</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6750000</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.8108927</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.4750000</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">0.2363969</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.1350000</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.3896029</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.3350000</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.1932809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5750000</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.1447494</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.4350000</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.0933681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.1850000</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.7288774</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.9250000</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.5376512</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.4350000</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">-0.0177200</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2550000</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.2355675</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.5600000</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.6274816</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.2000000</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.5297748</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8700000</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.6158927</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.7300000</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">-0.5086031</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.7200000</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">-0.0253971</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.2700000</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.1282809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.1800000</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.2502506</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.5500000</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">-0.0216319</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-3.0000000</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.5438774</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.5200000</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.1326512</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.5000000</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.9172800</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5600000</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">0.0694325</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.6041667</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.5833149</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.3158333</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.0139414</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5358333</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.9500594</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8958333</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">-0.3427698</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.2058333</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.4604363</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.4958333</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.3541143</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3058333</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.1244172</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.4841667</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.0442014</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.8941667</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.4380441</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.9141667</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.5268178</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.1841667</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.2331133</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.3258333</td>
<td style="text-align: right;">0.9583</td>
<td style="text-align: right;">0.4905675</td>
<td style="text-align: right;">0.1329762</td>
<td style="text-align: right;">-0.1647341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.6154545</td>
<td style="text-align: right;">0.0417</td>
<td style="text-align: right;">-1.1874816</td>
<td style="text-align: right;">0.1278142</td>
<td style="text-align: right;">0.5720271</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.1045455</td>
<td style="text-align: right;">0.1250</td>
<td style="text-align: right;">0.3297748</td>
<td style="text-align: right;">0.0783764</td>
<td style="text-align: right;">-0.2252293</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5045455</td>
<td style="text-align: right;">0.2083</td>
<td style="text-align: right;">1.4858927</td>
<td style="text-align: right;">0.0756092</td>
<td style="text-align: right;">-0.9813473</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.2045455</td>
<td style="text-align: right;">0.2917</td>
<td style="text-align: right;">2.2386031</td>
<td style="text-align: right;">0.0811237</td>
<td style="text-align: right;">-0.0340576</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.0645455</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">2.7453971</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.3191484</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.3745455</td>
<td style="text-align: right;">0.4583</td>
<td style="text-align: right;">2.1417191</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">0.2328264</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3745455</td>
<td style="text-align: right;">0.5417</td>
<td style="text-align: right;">0.4302506</td>
<td style="text-align: right;">0.0876044</td>
<td style="text-align: right;">-0.0557051</td>
</tr>
<tr class="even">
<td style="text-align: right;">-1.4554545</td>
<td style="text-align: right;">0.6250</td>
<td style="text-align: right;">-1.5283681</td>
<td style="text-align: right;">0.0876098</td>
<td style="text-align: right;">0.0729135</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.7154545</td>
<td style="text-align: right;">0.7083</td>
<td style="text-align: right;">-2.4561226</td>
<td style="text-align: right;">0.0811840</td>
<td style="text-align: right;">-0.2593319</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.7254545</td>
<td style="text-align: right;">0.7917</td>
<td style="text-align: right;">-2.3873488</td>
<td style="text-align: right;">0.0757368</td>
<td style="text-align: right;">-0.3381057</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.1154545</td>
<td style="text-align: right;">0.8750</td>
<td style="text-align: right;">-1.4172800</td>
<td style="text-align: right;">0.0803002</td>
<td style="text-align: right;">0.3018254</td>
</tr>
</tbody>
</table>
</div>

</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">augment</span><span class="op">(</span><span class="va">l1</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year_fraction</span>, y <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.fitted</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span>, ymax <span class="op">=</span> <span class="va">.fitted</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This line is only drawn using 12 points, so we might want to generate a smoother prediction by creating a new set of dates. We also add the original data to the plot.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>year_fraction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">co2</span><span class="op">$</span><span class="va">year_fraction</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">co2</span><span class="op">$</span><span class="va">year_fraction</span><span class="op">)</span>,</span>
<span>                                      length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">augment</span><span class="op">(</span><span class="va">l1</span>, newdata <span class="op">=</span> <span class="va">new_data</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year_fraction</span>, y <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.fitted</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span>,</span>
<span>                  ymax <span class="op">=</span> <span class="va">.fitted</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">co2_anomaly</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The LOESS function will not predict outside of the range of data provided, so I had to select the range of <code>new_data</code> above carefully to get the line to start and end near the first and last points.</p>
<p>Now we make two plots that contrast the results with different sized windows (<code>span</code>) and degree of the local regression models.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">co2_avg</span> <span class="op">~</span> <span class="va">decimal_date</span>, data <span class="op">=</span> <span class="va">co2</span>, </span>
<span>            degree <span class="op">=</span> <span class="fl">1</span>, span <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">l3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">co2_avg</span> <span class="op">~</span> <span class="va">decimal_date</span>, data <span class="op">=</span> <span class="va">co2</span>, </span>
<span>            degree <span class="op">=</span> <span class="fl">1</span>, span <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">new_data</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>decimal_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">co2</span><span class="op">$</span><span class="va">decimal_date</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">co2</span><span class="op">$</span><span class="va">decimal_date</span><span class="op">)</span>,</span>
<span>                                     length <span class="op">=</span> <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">l2</span>, newdata <span class="op">=</span> <span class="va">new_data</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">a3</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">l3</span>, newdata <span class="op">=</span> <span class="va">new_data</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">a2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">decimal_date</span>, y <span class="op">=</span> <span class="va">.fitted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.fitted</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span>, </span>
<span>                  ymax <span class="op">=</span> <span class="va">.fitted</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.20</span>, fill<span class="op">=</span><span class="st">"green"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">co2_avg</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">co2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">a3</span>, </span>
<span>            col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">a3</span>, </span>
<span>              <span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.fitted</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span>, </span>
<span>                  ymax <span class="op">=</span> <span class="va">.fitted</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">.se.fit</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.20</span>, fill<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">my_theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="120-gam-loess_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>LOESS fits are slow and take a lot of memory compared to other methods (both time and storage requirements increase like the square of the number of points), so they are usually only used for small data sets.</p>
</section><section id="packages-used" class="level2" data-number="17.3"><h2 data-number="17.3" class="anchored" data-anchor-id="packages-used">
<span class="header-section-number">17.3</span> Packages used</h2>
<p>In addition to <code>tidyverse</code>, <code>kableExtra</code> and <code>gapminder</code>, in this lesson we used</p>
<ul>
<li><code>broom</code></li>
<li>
<code>mgcv</code> for GAMs</li>
<li>
<code>gratia</code> for plotting and extracting information from GAMs</li>
</ul></section><section id="further-reading" class="level2" data-number="17.4"><h2 data-number="17.4" class="anchored" data-anchor-id="further-reading">
<span class="header-section-number">17.4</span> Further reading</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Local_regression">LOESS (Wikipedia)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Generalized_additive_model">Generalized additive models (Wikipedia)</a></li>
</ul>
<div class="cell">

</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../lessons/119-linear-models.html" class="pagination-link  aria-label=" models="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linear models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lessons/124-collaboration.html" class="pagination-link" aria-label="<span class='chapter-number'>18</span>&nbsp; <span class='chapter-title'>Collaborating with GitHub</span>">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Collaborating with GitHub</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>